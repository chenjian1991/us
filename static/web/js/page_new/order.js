$(function(){window.onload=function(){var i=new Swiper("#tabs-container",{initialSlide:0,speed:500,simulateTouch:!1,on:{slideChangeTransitionStart:function(){$(".tab-panel .active").removeClass("active"),$(".tab-panel a").eq(this.activeIndex).addClass("active")}}});$(".tab-panel a").on("click",function(e){e.preventDefault(),$(".tab-panel .active").removeClass("active"),$(this).addClass("active"),i.slideTo($(this).index())})}}),loginToken||(window.location.href="../exchange/b11/index.html#/login");var ssoProvider={getSsoToken:function(e){loginToken&&e(loginToken)}},exchange=new Exchange(ssoProvider),sso=new Sso,QuoteList=function(){},quoteList=new QuoteList,symbolList=[];function scientificToNumber(e){var i,t,o=e.toString(),s=/^(\d+\.?\d*)(e)([\-]?\d+)$/,a="";if(s.test(o)){i=s.exec(o),t=Math.abs(i[3])-1;for(var l=0;l<t;l++)a+="0";return"0."+a+i[1].replace(".","")}return e}exchange.getSymbolList(function(e){var o=void 0,s=void 0,a=void 0;$.each(e,function(e,i){function t(e){return e.toString().length<3?0:scientificToNumber(e).toString().length-2}o=t(i.priceTickSize),s=t(i.quantityStepSize),a=scientificToNumber(i.quotePrecision),symbolList.push([i.symbol,o,s,a])})});var openPages=void 0,completePages=void 0,filledPages=void 0,currentPage=void 0,getFilledPages=setInterval(function(){filledPages&&(clearInterval(getFilledPages),$("#filled_paging").whjPaging({totalPage:filledPages,showPageNum:3,previousPage:"<",nextPage:">",isShowFL:!1,isShowPageSizeOpt:!1,isShowSkip:!1,isShowRefresh:!1,isShowTotalPage:!1,isResetPage:!1,callBack:function(e){quoteList.getFilledOrderList(e)}}))},500);QuoteList.prototype.getOpenOrderList=function(t){exchange.listOpenOrder(function(e){if(0!=e.length){$("#no_open_order").addClass("dis-n"),openPages&&openPages==Math.ceil(e.length/10)||(openPages=Math.ceil(e.length/10),$("#open_paging").whjPaging({totalPage:openPages,showPageNum:3,previousPage:"<",nextPage:">",refresh:!0,isShowFL:!1,isShowPageSizeOpt:!1,isShowSkip:!1,isShowRefresh:!1,isShowTotalPage:!1,isResetPage:!1,callBack:function(e){currentPage=e,quoteList.getOpenOrderList(e)}})),e=t&&t==openPages?e.slice(10*(t-1),10*t):t&&openPages<t?e.slice(10*(openPages-1),10*openPages):e.slice(0,10);var o=void 0,s=void 0,a=void 0,i=setInterval(function(){0!=symbolList.length&&(clearInterval(i),$.each(e,function(e,t){$.each(symbolList,function(e,i){if(t.symbol==i[0])return o=i[1],s=i[2],a=i[3],!1}),t.createdAt=transform_date(t.createdAt),t.limitPrice=keepDecimals(scientificToNumber(t.limitPrice),o),t.filledCumulativeQuantity=keepDecimals(t.filledCumulativeQuantity,s),t.quantity=keepDecimals(scientificToNumber(t.quantity),s),t.filled=(t.filledCumulativeQuantity/t.quantity*100).toFixed(2),t.total=keepDecimals(new BigDecimal(t.limitPrice.toString()).multiply(new BigDecimal(t.quantity.toString())).toString(),a);var i=t.symbol.slice(-3);switch(i){case"BTC":case"ETH":t.symbol=t.symbol.slice(0,-3)+"/"+i;break;default:t.symbol=t.symbol.slice(0,-4)+"/"+t.symbol.slice(-4)}}),$(".open-order-content").remove(),$("#open_order_list").tmpl(e).appendTo("#open_table"),layerInternational(),orderSideColor())},100)}else $(".open-order-content").remove(),$("#no_open_order").removeClass("dis-n")})},QuoteList.prototype.getCompleteOrderList=function(e){exchange.listCompletedOrder(e,function(e){if(completePages&&completePages==e.pages||(completePages=e.pages,$("#complete_paging").whjPaging({totalPage:completePages,showPageNum:3,previousPage:"<",nextPage:">",isShowFL:!1,isShowPageSizeOpt:!1,isShowSkip:!1,isShowRefresh:!1,isShowTotalPage:!1,isResetPage:!1,callBack:function(e){quoteList.getCompleteOrderList(e)}})),0!=e.data.length){$("#no_history_order").addClass("dis-n");var i=e.data,o=void 0,s=void 0,a=void 0,t=setInterval(function(){0!=symbolList.length&&(clearInterval(t),$.each(i,function(e,t){$.each(symbolList,function(e,i){if(t.symbol==i[0])return o=i[1],s=i[2],a=i[3],!1}),t.createdAt=transform_date(t.createdAt),t.limitPrice=keepDecimals(scientificToNumber(t.limitPrice),o),t.quantity=keepDecimals(scientificToNumber(t.quantity),s),t.filledAveragePrice=keepDecimals(scientificToNumber(t.filledAveragePrice),o),t.filledCumulativeQuantity=keepDecimals(scientificToNumber(t.filledCumulativeQuantity),s),t.filled=(t.filledCumulativeQuantity/t.quantity*100).toFixed(2),t.total=keepDecimals(new BigDecimal(t.filledAveragePrice.toString()).multiply(new BigDecimal(t.filledCumulativeQuantity.toString())).toString(),a);var i=t.symbol.slice(-3);switch(i){case"BTC":case"ETH":t.symbol=t.symbol.slice(0,-3)+"/"+i;break;default:t.symbol=t.symbol.slice(0,-4)+"/"+t.symbol.slice(-4)}}),$(".history-order-content").remove(),$("#history_order_list").tmpl(i).appendTo("#complete_table"),layerInternational(),orderSideColor())},100)}else $("#no_history_order").removeClass("dis-n")})},QuoteList.prototype.getFilledOrderList=function(e){exchange.listFilledOrder(e,function(e){if(filledPages=e.pages,0!=e.data.length){$("#no_filled_order").addClass("dis-n");var i=e.data,o=void 0,s=void 0,a=void 0,t=setInterval(function(){0!=symbolList.length&&(clearInterval(t),$.each(i,function(e,t){$.each(symbolList,function(e,i){if(t.symbol==i[0])return o=i[1],s=i[2],a=i[3],!1}),t.createdAt=transform_date(t.createdAt),t.lastFilledPrice=keepDecimals(scientificToNumber(t.lastFilledPrice),o),t.lastFilledQuantity=keepDecimals(scientificToNumber(t.lastFilledQuantity),s);var i=t.symbol.slice(-3);switch(i){case"BTC":case"ETH":t.symbol=t.symbol.slice(0,-3)+"/"+i;break;default:t.symbol=t.symbol.slice(0,-4)+"/"+t.symbol.slice(-4)}-1==t.lastCommission.toString().indexOf("e")?"BUY"==t.orderSide?t.lastCommission=keepDecimals(scientificToNumber(t.lastCommission),a)+" "+t.symbol.slice(0,t.symbol.indexOf("/")):t.lastCommission=keepDecimals(scientificToNumber(t.lastCommission),a)+" "+t.symbol.slice(t.symbol.indexOf("/")+1):"BUY"==t.orderSide?t.lastCommission=t.lastCommission.toFixed(a)+" "+t.symbol.slice(0,t.symbol.indexOf("/")):t.lastCommission=t.lastCommission.toFixed(a)+" "+t.symbol.slice(t.symbol.indexOf("/")+1),t.total=keepDecimals(new BigDecimal(t.lastFilledPrice.toString()).multiply(new BigDecimal(t.lastFilledQuantity.toString())).toString(),a)+" "+t.symbol.slice(t.symbol.indexOf("/")+1)}),$(".filled-order-content").remove(),$("#filled_order_list").tmpl(i).appendTo("#filled_table"),layerInternational(),orderSideColor())},100)}else $("#no_filled_order").removeClass("dis-n")})},quoteList.getOpenOrderList(),quoteList.getCompleteOrderList(),quoteList.getFilledOrderList();var regExp=/^\d{0,6}$/;function emptyPasswordInput(){$("input[data-attr='tradePassword']").val(""),$(".fakebox input").each(function(){$(this).val("")})}$("input[data-attr='tradePassword']").bind("input propertychange",function(e){for(var i=this,t=e.target.value,o=$(".fakebox input"),s=t.length;0<s;s--)if(regExp.test(t.slice(0,s)))o.eq(s-1).val(t[s-1]);else if(0<chrome||0<firefox){if(getCursorPosition(i)<t.slice(0,s).length)return t=t.slice(0,getCursorPosition(i)-1)+t.slice(getCursorPosition(i)),$(i).val(t),void o.eq(s).val(t[s]);t=t.slice(0,s-1),$(i).val(t),o.eq(s).val(t[s])}else 0<safari&&(t=t.slice(0,s-1),$(i).val(t),o.eq(s).val(t[s]));o.each(function(){$(this).index()>=t.length&&$(this).val("")}),/^\d/.test(t)||($(this).val(""),o.eq(0).val(""))});var orderID=void 0;function cancel(e){$(".error .prompt").addClass("dis-n"),orderID=$(e).parent().attr("data-order-id"),getValue("ORDER_SESSION")?exchange.cancelOrder(orderID,function(e){e&&setTimeout(function(){quoteList.getOpenOrderList(currentPage),quoteList.getCompleteOrderList()},500)}):alert_box()}$(".confirm").click(function(){$(".error .prompt").addClass("dis-n");var e=$("input[data-attr='tradePassword']").val();!e.trim()||e.length<6?showError("password-error"):sso.issuedTradePassword(loginToken,e,function(e){e.code?(emptyPasswordInput(),textError(Sso.errorMessage[localStorage.getItem("countryLanguage")][e.code])):(hide_alert(),exchange.ssoProvider.getExtension=e.token,exchange.cancelOrder(orderID,function(e){e&&setTimeout(function(){quoteList.getOpenOrderList(),quoteList.getCompleteOrderList(),quoteList.getFilledOrderList()},500)}))})}),$("#close_icon,#close").click(function(){hide_alert(),emptyPasswordInput(),$(".error .prompt").addClass("dis-n")});